<!doctype html><html lang=ja><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=google-site-verification content="pSbXNmFro4N0qXaPu_wpSJzM4EiCIxuItQNdD7BxJoU"><meta name=generator content="Hugo 0.62.0"><link rel=icon href=https://zEttOn86.github.io/images/logo.png><link rel="shortcut icon" href=https://zEttOn86.github.io/images/logo.ico><link rel=apple-touch-icon href=https://zEttOn86.github.io/images/logo.ico><title>How to draw the Euler angles in the xy plane for head pose | まぁそういう時もある。</title><meta name=author content="zEttOn86"><meta name=description content="How to draw the Euler angles in the xy plane for head pose"><meta name=keywords content="euler angles,head pose"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://zEttOn86.github.io"><meta name=twitter:title content="How to draw the Euler angles in the xy plane for head pose"><meta name=twitter:description content="How to draw the Euler angles in the xy plane for head pose"><meta property="og:title" content="How to draw the Euler angles in the xy plane for head pose"><meta property="og:description" content="How to draw the Euler angles in the xy plane for head pose"><meta property="og:type" content="article"><meta property="og:url" content="https://zEttOn86.github.io/blog/20240105_how_to_draw_euler_angles_in_xy_plane/"><meta property="og:image" content="https://zEttOn86.github.io"><meta property="article:published_time" content="2024-01-05T22:39:14+09:00"><meta property="article:modified_time" content="2024-01-16T21:41:27+09:00"><link href=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css rel=stylesheet integrity=sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.0.13/css/all.css integrity=sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp crossorigin=anonymous><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Noto+Sans&family=Noto+Sans+JP&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel=stylesheet><link href=https://zEttOn86.github.io/css/medium.css rel=stylesheet><link href=https://zEttOn86.github.io/css/additional.css rel=stylesheet><link href=https://zEttOn86.github.io/css/custom.css rel=stylesheet><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">MathJax.Hub.Config({tex2jax:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$']],processEscapes:true,processEnvironments:true,skipTags:['script','noscript','style','textarea','pre'],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}});MathJax.Hub.Queue(function(){var all=MathJax.Hub.getAllJax(),i;for(i=0;i<all.length;i+=1){all[i].SourceElement().parentNode.className+=' has-jax';}});MathJax.Hub.Config({TeX:{equationNumbers:{autoNumber:"AMS"}}});</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-9NRRDF48L8"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-9NRRDF48L8');</script></head><body><nav class="navbar navbar-expand-lg navbar-light bg-secondary fixed-top mediumnavigation nav-down custom-hamburger"><div class="container pr-0"><a class=navbar-brand style="font-family:Noto Sans JP;color:#f5f5f5" href=https://zEttOn86.github.io>まぁそういう時もある。</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarMediumish aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarMediumish><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link style=color:#f5f5f5 href=https://zEttOn86.github.io/about>About Me</a></li><li class=nav-item><a class=nav-link style=color:#f5f5f5 href=https://zEttOn86.github.io/static/disclaimers>Disclaimers</a></li><li class=nav-item><a class=nav-link style=color:#f5f5f5 href=https://zEttOn86.github.io/static/privacy-policy>Privacy Policy</a></li></ul></div></div></nav><div class=site-content><div class=container><div class=main-content><div class=container><div class=row><div class="col-md-10 offset-md-1 flex-first flex-md-unordered"><div class=mainheading><span class=lastmod><li><i class="fas fa-pencil-alt"></i><time datetime=2024-01-05T22:39:14JST>Jan 5, 2024</time></li><li><i class="fas fa-sync-alt"></i><time datetime=2024-01-16T21:41:27JST>Jan 16, 2024</time></li></span><h1 class=posttitle>How to draw the Euler angles in the xy plane for head pose</h1><div class=after-post-tags><ul class=tags><li><a href=https://zEttOn86.github.io/categories/%E6%8A%80%E8%A1%93%E7%B3%BB><i class="fa fa-folder"></i>技術系</a></li>&nbsp;<li><a href=https://zEttOn86.github.io/tags/euler-angles><i class="fa fa-tags"></i>euler angles</a></li><li><a href=https://zEttOn86.github.io/tags/head-pose><i class="fa fa-tags"></i>head pose</a></li></ul></div></div><nav id=TableOfContents><ul><li><a href=#head-pose-visualization>Head pose visualization</a></li><li><a href=#the-euler-angles-for-head-pose>The Euler angles for head pose</a></li><li><a href=#1-convert-the-euler-angles-to-the-rotation-matrix>1. Convert the Euler angles to the rotation matrix</a></li><li><a href=#2-project-the-xyz-unit-vector-onto-the-xy-plane>2. Project the xyz unit vector onto the xy plane</a></li><li><a href=#sample-code-aflw2000>Sample code (AFLW2000)</a></li><li><a href=#summary>Summary</a></li><li><a href=#reference>Reference</a></li></ul></nav><div class=article-post><p>When I drew the head pose on the xy plane, I had no idea how to draw it.
This article is just a summary.</p><h2 id=head-pose-visualization>Head pose visualization</h2><p>Head pose is a representation of the human head orientation.<br>To visualise head pose, this article draws the xyz unit vector on an image of a human head.<br>X-axis is drawn in red<br>Y-axis is drawn in green<br>Z-axis (out of the screen) is drawn in blue<br><figure class="center title-center"><img src=https://zEttOn86.github.io/images/blog/20240105/1.png alt=1 width=75%></figure></p><div>From: <a href=https://arxiv.org/abs/2309.07654>Towards Robust and Unconstrained Full Range of Rotation Head Pose Estimation</a></div><h2 id=the-euler-angles-for-head-pose>The Euler angles for head pose</h2><p>The definition of the Euler angles for head pose is shown in the following left figure.<figure class="center title-center"><img src=https://zEttOn86.github.io/images/blog/20240105/2.png alt=1 width=75%></figure></p><div>From: <a href=https://en.wikipedia.org/wiki/Aircraft_principal_axes>Aircraft principal axes</a></div><br>The representation of roll, pitch and yaw in xyz space depends on a perspective (field).<br>For example, a roll from the airplane's perspective rotates around the X-axis, but a roll from the head pose's perspective rotates around the Z-axis.<h2 id=1-convert-the-euler-angles-to-the-rotation-matrix>1. Convert the Euler angles to the rotation matrix</h2><p>From this chapter, I explain how to draw the Euler angles in the xy plane.<br>First of all, convert the Euler angles to rotation matirx.<br>The following three basic rotation matrices rotate vectors by the Euler angles using the right-hand rule.<br>The rotation matrix of the X-axis is represented by $\boldsymbol{R_x}$, the rotation matrix of the Y-axis by $\boldsymbol{R_y}$ and the rotation matrix of the Z-axis by $\boldsymbol{R_z}$.</p><p>\begin{eqnarray}
\boldsymbol{R_x} &=&
\left(
\begin{array}{ccc}
1 & 0 & 0 \<br>0 & \cos\theta_{x} & -\sin\theta_{x} \<br>0 & \sin\theta_{x} & \cos\theta_{x}
\end{array}
\right) \<br>\end{eqnarray}</p><p>\begin{eqnarray}
\boldsymbol{R_y} &=&
\left(
\begin{array}{ccc}
\cos\theta_{y} & 0 & \sin\theta_{y} \<br>0 & 1 & 0 \<br>-\sin\theta_{y} & 0 & \cos\theta_{y}
\end{array}
\right) \<br>\end{eqnarray}</p><p>\begin{eqnarray}
\boldsymbol{R_z} &=&
\left(
\begin{array}{ccc}
\cos\theta_{z} & -\sin\theta_{z} & 0 \<br>\sin\theta_{z} & \cos\theta_{z} & 0 \<br>0 & 0 & 1
\end{array}
\right)
\end{eqnarray}</p><blockquote><p>Note:<br>Please replace $\theta_{x}$, $\theta_{y}$ and $\theta_{z}$ to the Euler angles.<br>e.g. $\theta_{x}$ means $\theta_{pitch}$ for head pose.</p></blockquote><p>This article rotates in the order Z, Y, X (roll, yaw, pitch).<br>Note that the order of rotation affects the final result.</p><p>\begin{eqnarray}
\boldsymbol{R_{zyx}} = \boldsymbol{R_x}\boldsymbol{R_y}\boldsymbol{R_z} =
\left(
\begin{array}{ccc}
\cos\theta_{y}\cos\theta_{z} & -\cos\theta_{y}\sin\theta_{z} & \sin\theta_{y} \<br>\sin\theta_{x}\sin\theta_{y}\cos\theta_{z} + \cos\theta_{x}\sin\theta_{z} & -\sin\theta_{x}\sin\theta_{y}\sin\theta_{z} + \cos\theta_{x}\cos\theta_{z} & -\sin\theta_{x}\cos\theta_{y} \<br>-\cos\theta_{x}\sin\theta_{y}\cos\theta_{z} + \sin\theta_{x}\sin\theta_{z} & \cos\theta_{x}\sin\theta_{y}\sin\theta_{z} + \sin\theta_{x}\cos\theta_{z} & \cos\theta_{x}\cos\theta_{y}
\end{array}
\right)
\end{eqnarray}</p><ul><li><a href="https://ja.wolframalpha.com/input?i=%28%281%2C0%2C0%29%2C%280%2Ccos%28x%29%2C-sin%28x%29%29%2C%280%2Csin%28x%29%2Ccos%28x%29%29%29*%28%28cos%28y%29%2C0%2Csin%28y%29%29%2C%280%2C1%2C0%29%2C%28-sin%28y%29%2C0%2Ccos%28y%29%29%29*%28%28cos%28z%29%2C-sin%28z%29%2C0%29%2C%28sin%28z%29%2Ccos%28z%29%2C0%29%2C%280%2C0%2C1%29%29">Wolfram Alpha : rotate in the order Z, Y, X</a></li></ul><p>The following equations use roll, pitch and yaw notation.
\begin{eqnarray}
\boldsymbol{R_{xyz}} =
\left(
\begin{array}{ccc}
\cos\theta_{yaw}\cos\theta_{roll} & -\cos\theta_{yaw}\sin\theta_{roll} & \sin\theta_{yaw} \<br>\sin\theta_{pitch}\sin\theta_{yaw}\cos\theta_{roll} + \cos\theta_{pitch}\sin\theta_{roll} & -\sin\theta_{pitch}\sin\theta_{yaw}\sin\theta_{roll} + \cos\theta_{pitch}\cos\theta_{roll} & -\sin\theta_{pitch}\cos\theta_{yaw} \<br>-\cos\theta_{pitch}\sin\theta_{yaw}\cos\theta_{roll} + \sin\theta_{pitch}\sin\theta_{roll} & \cos\theta_{pitch}\sin\theta_{yaw}\sin\theta_{roll} + \sin\theta_{pitch}\cos\theta_{roll} & \cos\theta_{pitch}\cos\theta_{yaw}
\end{array}
\right)
\end{eqnarray}</p><h2 id=2-project-the-xyz-unit-vector-onto-the-xy-plane>2. Project the xyz unit vector onto the xy plane</h2><p>Next, to visualize the Euler angles, I draw the xyz unit vector in the xy plane (an image) as explained above.<br>The xyz unit vectors are represented as follows.
\begin{eqnarray}
\boldsymbol{e_{x}} =
\left(
\begin{array}{c}
1 \<br>0 \<br>0
\end{array}
\right)
\boldsymbol{e_{y}} =
\left(
\begin{array}{c}
0 \<br>1 \<br>0
\end{array}
\right)
\boldsymbol{e_{z}} =
\left(
\begin{array}{c}
0 \<br>0 \<br>1
\end{array}
\right)
\end{eqnarray}</p><br>To project the xyz unit vector onto the xy plane, multiply the rotation matrix as follows<br><p>\begin{eqnarray}
\widehat{\boldsymbol{e_{x}}} =
\left(
\begin{array}{rcc}
1 & 0 & 0 \<br>0 & 1 & 0 \<br>0 & 0 & 0
\end{array}
\right)
\boldsymbol{R_{x}}
\boldsymbol{R_{y}}
\boldsymbol{R_{z}}
\boldsymbol{e_{x}} =
\left(
\begin{array}{c}
\cos\theta_{y}\cos\theta_{z} \<br>\sin\theta_{x}\sin\theta_{y}\cos\theta_{z} + \cos\theta_{x}\sin\theta_{z} \<br>0
\end{array}
\right) \<br>\widehat{\boldsymbol{e_{y}}} =
\left(
\begin{array}{rcc}
1 & 0 & 0 \<br>0 & 1 & 0 \<br>0 & 0 & 0
\end{array}
\right)
\boldsymbol{R_{x}}
\boldsymbol{R_{y}}
\boldsymbol{R_{z}}
\boldsymbol{e_{y}} =
\left(
\begin{array}{c}
-\cos\theta_{y}\sin\theta_{z} \<br>-\sin\theta_{x}\sin\theta_{y}\sin\theta_{z} + \cos\theta_{x}\cos\theta_{z} \<br>0
\end{array}
\right) \<br>\widehat{\boldsymbol{e_{z}}} =
\left(
\begin{array}{rcc}
1 & 0 & 0 \<br>0 & 1 & 0 \<br>0 & 0 & 0
\end{array}
\right)
\boldsymbol{R_{x}}
\boldsymbol{R_{y}}
\boldsymbol{R_{z}}
\boldsymbol{e_{z}} =
\left(
\begin{array}{c}
\sin\theta_{y} \<br>-\sin\theta_{x}\cos\theta_{y} \<br>0
\end{array}
\right) \<br>\end{eqnarray}</p><br>The Euler angles can be represented on the image by drawing the XY elements of the above equation (7) ~ (8) in the xy plane.<h2 id=sample-code-aflw2000>Sample code (AFLW2000)</h2><p>Example of command line:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>python3 view.py --dataset_root &lt;path/to/the/AFLW2000/root/directory&gt; --filename image00078
</code></pre></div><p>Example of execution:<figure class="center title-center"><img src=https://zEttOn86.github.io/images/blog/20240105/3.png alt=1 width=50%></figure></p><p>Sample code (view.py):</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#f92672>import</span> os
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#f92672>import</span> argparse
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#f92672>import</span> cv2
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#f92672>import</span> numpy <span style=color:#f92672>as</span> np
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#f92672>import</span> scipy.io <span style=color:#f92672>as</span> sio
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#f92672>from</span> math <span style=color:#f92672>import</span> cos, sin
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>parse_args</span>():
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>    parser <span style=color:#f92672>=</span> argparse<span style=color:#f92672>.</span>ArgumentParser()
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>    parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>--datasets_root</span><span style=color:#e6db74>&#39;</span>,
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>                        help<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>Path to the root directory of AFLW2000 datasets</span><span style=color:#e6db74>&#39;</span>,
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>                        type<span style=color:#f92672>=</span>str)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>    parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>--filename</span><span style=color:#e6db74>&#39;</span>,
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span>                        help<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>Filename without extension to load the data</span><span style=color:#e6db74>&#39;</span>,
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span>                        type<span style=color:#f92672>=</span>str)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>    args <span style=color:#f92672>=</span> parser<span style=color:#f92672>.</span>parse_args()
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>    <span style=color:#66d9ef>return</span> args
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_R</span>(x,y,z):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span>    <span style=color:#e6db74></span><span style=color:#e6db74>&#39;&#39;&#39;</span><span style=color:#e6db74> Get rotation matrix from three rotation angles (radians). right-handed.</span><span style=color:#e6db74>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span style=color:#e6db74></span><span style=color:#e6db74>    Args:</span><span style=color:#e6db74>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span style=color:#e6db74></span><span style=color:#e6db74>        angles: [3,]. x, y, z angles</span><span style=color:#e6db74>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span style=color:#e6db74></span><span style=color:#e6db74>    Returns:</span><span style=color:#e6db74>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span style=color:#e6db74></span><span style=color:#e6db74>        R: [3, 3]. rotation matrix.</span><span style=color:#e6db74>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span style=color:#e6db74></span><span style=color:#e6db74>    </span><span style=color:#e6db74>&#39;&#39;&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span>    <span style=color:#75715e># x</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span>    Rx <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array([[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>],
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span>                   [<span style=color:#ae81ff>0</span>, np<span style=color:#f92672>.</span>cos(x), <span style=color:#f92672>-</span>np<span style=color:#f92672>.</span>sin(x)],
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span>                   [<span style=color:#ae81ff>0</span>, np<span style=color:#f92672>.</span>sin(x), np<span style=color:#f92672>.</span>cos(x)]])
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span>    <span style=color:#75715e># y</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span>    Ry <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array([[np<span style=color:#f92672>.</span>cos(y), <span style=color:#ae81ff>0</span>, np<span style=color:#f92672>.</span>sin(y)],
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span>                   [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>],
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span>                   [<span style=color:#f92672>-</span>np<span style=color:#f92672>.</span>sin(y), <span style=color:#ae81ff>0</span>, np<span style=color:#f92672>.</span>cos(y)]])
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span>    <span style=color:#75715e># z</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span>    Rz <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array([[np<span style=color:#f92672>.</span>cos(z), <span style=color:#f92672>-</span>np<span style=color:#f92672>.</span>sin(z), <span style=color:#ae81ff>0</span>],
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span>                   [np<span style=color:#f92672>.</span>sin(z), np<span style=color:#f92672>.</span>cos(z), <span style=color:#ae81ff>0</span>],
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span>                   [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>]])
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span>    R <span style=color:#f92672>=</span> Rx<span style=color:#f92672>.</span>dot(Ry<span style=color:#f92672>.</span>dot(Rz))
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span>    <span style=color:#66d9ef>return</span> R
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44</span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74></span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>__main__</span><span style=color:#e6db74>&#34;</span>:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45</span>    args <span style=color:#f92672>=</span> parse_args()
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47</span>    image_file <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(args<span style=color:#f92672>.</span>datasets_root, <span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{}.jpg</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>.</span>format(args<span style=color:#f92672>.</span>filename))
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48</span>    mat_file <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(args<span style=color:#f92672>.</span>datasets_root, <span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{}.mat</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>.</span>format(args<span style=color:#f92672>.</span>filename))
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50</span>    <span style=color:#75715e># Load .jpg</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51</span>    img <span style=color:#f92672>=</span> cv2<span style=color:#f92672>.</span>imread(image_file)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52</span>    <span style=color:#75715e># Load .mat</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53</span>    mat <span style=color:#f92672>=</span> sio<span style=color:#f92672>.</span>loadmat(mat_file)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55</span>    <span style=color:#75715e># [pitch yaw roll tdx tdy tdz scale_factor]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">56</span>    pre_pose_params <span style=color:#f92672>=</span> mat[<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>Pose_Para</span><span style=color:#e6db74>&#39;</span>][<span style=color:#ae81ff>0</span>]
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">57</span>    <span style=color:#75715e># Get [pitch, yaw, roll]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">58</span>    pitch, yaw, roll <span style=color:#f92672>=</span> pre_pose_params[:<span style=color:#ae81ff>3</span>]
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">59</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">60</span>    <span style=color:#75715e># Covert to R</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">61</span>    x <span style=color:#f92672>=</span> pitch
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">62</span>    y <span style=color:#f92672>=</span> <span style=color:#f92672>-</span>yaw
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">63</span>    z <span style=color:#f92672>=</span> roll
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">64</span>    R <span style=color:#f92672>=</span> get_R(x, y, z)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">65</span>    <span style=color:#66d9ef>print</span>(<span style=color:#e6db74></span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>Rotation matrix:</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, R)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">66</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">67</span>    <span style=color:#75715e># Draw Axis</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">68</span>    cx <span style=color:#f92672>=</span> img<span style=color:#f92672>.</span>shape[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>/</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">69</span>    cy <span style=color:#f92672>=</span> img<span style=color:#f92672>.</span>shape[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>/</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">70</span>    size <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">71</span>    <span style=color:#75715e># X-axis pointing to right. drawn in red</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">72</span>    x1 <span style=color:#f92672>=</span> size <span style=color:#f92672>*</span> R[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> cx
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">73</span>    y1 <span style=color:#f92672>=</span> size <span style=color:#f92672>*</span> R[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> cy
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">74</span>    <span style=color:#75715e># Y-axis drawn in green</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">75</span>    x2 <span style=color:#f92672>=</span> size <span style=color:#f92672>*</span> R[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> cx
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">76</span>    y2 <span style=color:#f92672>=</span> size <span style=color:#f92672>*</span> R[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> cy
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">77</span>    <span style=color:#75715e># Z-axis (out of the screen) drawn in blue</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">78</span>    x3 <span style=color:#f92672>=</span> size <span style=color:#f92672>*</span> R[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>] <span style=color:#f92672>+</span> cx
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">79</span>    y3 <span style=color:#f92672>=</span> size <span style=color:#f92672>*</span> R[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>] <span style=color:#f92672>+</span> cy
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">80</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">81</span>    cv2<span style=color:#f92672>.</span>line(img, (int(cx), int(cy)), (int(x1),int(y1)), (<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>255</span>), <span style=color:#ae81ff>2</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">82</span>    cv2<span style=color:#f92672>.</span>line(img, (int(cx), int(cy)), (int(x2),int(y2)), (<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>0</span>), <span style=color:#ae81ff>2</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">83</span>    cv2<span style=color:#f92672>.</span>line(img, (int(cx), int(cy)), (int(x3),int(y3)), (<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>), <span style=color:#ae81ff>2</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">84</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">85</span>    cv2<span style=color:#f92672>.</span>imshow(<span style=color:#e6db74></span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>View</span><span style=color:#e6db74>&#34;</span>, img)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">86</span>    cv2<span style=color:#f92672>.</span>waitKey(<span style=color:#ae81ff>0</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">87</span>    cv2<span style=color:#f92672>.</span>destroyAllWindows()
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">88</span>    <span style=color:#66d9ef>print</span>(<span style=color:#e6db74></span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>End</span><span style=color:#e6db74>&#34;</span>)</code></pre></div><h2 id=summary>Summary</h2><p>The representation of roll, pitch and yaw in xyz space depends on a perspective.<br>Therefore I need to be concerned about which field I am dealing with, e.g.head pose, airplane.</p><h2 id=reference>Reference</h2><ul><li><a href=https://en.wikipedia.org/wiki/Aircraft_principal_axes>Aircraft principal axes</a></li><li><a href=https://arxiv.org/abs/2309.07654>Towards Robust and Unconstrained Full Range of Rotation Head Pose Estimation</a></li><li><a href=https://qiita.com/aa_debdeb/items/3d02e28fb9ebfa357eaf>回転行列、クォータニオン(四元数)、オイラー角の相互変換</a></li><li><a href=https://github.com/Mostafa-Nafie/Head-Pose-Estimation>Head-Pose-Estimation</a></li><li><a href=https://github.com/PINTO0309/300W_LP_AFLW2000_viewer>PINTO0309/300W_LP_AFLW2000_viewer</a></li></ul></div><div class="row PageNavigation d-flex justify-content-between font-weight-bold"><a class="d-block col-md-6 text-lg-right" href=https://zEttOn86.github.io/blog/20231209-flowers_for_algernon/>「アルジャーノンに花束を」を読んだ &#187;</a><div class=clearfix></div></div></div></div></div><div class=container><div id=comments class="row justify-content-center mb-5"><div class=col-md-8><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"learning-notes-1"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div></div></div><footer class=footer><div class=container><div class=row><div class="col-md-6 col-sm-6 text-center text-lg-left">&copy; Copyright 2019-2020, zEttOn86 - All rights reserved</div><div class="col-md-6 col-sm-6 text-center text-lg-right"></div></div></div></footer></div><script src=https://code.jquery.com/jquery-3.4.1.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js integrity=sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js integrity=sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM crossorigin=anonymous></script><script src=https://zEttOn86.github.io/js/mediumish.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-155190510-1','auto');ga('send','pageview');}</script></body></html>